{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/api/file-loading.service\";\nimport * as i2 from \"../collapsible/collapsible.component\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../image-library-modal/image-library-modal.component\";\n\nfunction FileInputComponent_i_image_library_modal_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"i-image-library-modal\", 9);\n    i0.ɵɵlistener(\"onSelect\", function FileInputComponent_i_image_library_modal_12_Template_i_image_library_modal_onSelect_0_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.selectImage($event);\n    })(\"onHide\", function FileInputComponent_i_image_library_modal_12_Template_i_image_library_modal_onHide_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.hideLibrary();\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"selectedImage\", ctx_r1.selectedImage)(\"projectId\", ctx_r1.projectId)(\"period\", ctx_r1.period);\n  }\n}\n\nexport let FileInputComponent = /*#__PURE__*/(() => {\n  class FileInputComponent {\n    constructor(fileLoadingService) {\n      this.fileLoadingService = fileLoadingService; // images: Image[];\n\n      this.libraryShown = false;\n      this.onSelect = new EventEmitter();\n    }\n\n    ngOnInit() {}\n\n    onChange(e) {\n      const selectedFiles = Array.from(e.target.files);\n      let formData = new FormData();\n\n      for (let index = 0; index < selectedFiles.length; index++) {\n        formData.append(`files[]`, selectedFiles[index], `file${selectedFiles[index].name}`);\n      }\n\n      if (this.projectId) {\n        formData.append('project_id', this.projectId.toString());\n      }\n\n      if (this.period) {\n        formData.append('period', this.period);\n      }\n\n      this.fileLoadingService.upload(formData).subscribe(images => {\n        if (this.libraryShown) {\n          this.hideLibrary();\n          setTimeout(() => {\n            this.showLibrary();\n          }, 100);\n        } else {\n          this.showLibrary();\n        } // this.images = images; \n\n      }, err => {\n        console.log(err);\n      });\n    } // closeUploaded() {\n    //   this.images = null;\n    // }\n\n\n    showLibrary() {\n      this.libraryShown = true;\n    }\n\n    hideLibrary() {\n      this.libraryShown = false;\n    }\n\n    selectImage(image) {\n      this.selectedImage = image;\n      this.onSelect.emit(image);\n    }\n\n  }\n\n  FileInputComponent.ɵfac = function FileInputComponent_Factory(t) {\n    return new (t || FileInputComponent)(i0.ɵɵdirectiveInject(i1.FileLoadingService));\n  };\n\n  FileInputComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FileInputComponent,\n    selectors: [[\"i-image-input\"]],\n    inputs: {\n      projectId: \"projectId\",\n      period: \"period\"\n    },\n    outputs: {\n      onSelect: \"onSelect\"\n    },\n    decls: 13,\n    vars: 7,\n    consts: [[3, \"expanded\"], [1, \"thumbs-item\", \"preview\"], [\"type\", \"text\", \"placeholder\", \"[empty]\", \"readonly\", \"\", 1, \"none\", 3, \"value\"], [1, \"row\"], [\"type\", \"button\", 3, \"click\"], [\"src\", \"/assets/icons/upload.svg\", \"alt\", \"UPLOAD\"], [\"type\", \"file\", \"multiple\", \"\", \"accept\", \".png, .jpg, .jpeg\", 3, \"change\"], [\"file\", \"\"], [3, \"selectedImage\", \"projectId\", \"period\", \"onSelect\", \"onHide\", 4, \"ngIf\"], [3, \"selectedImage\", \"projectId\", \"period\", \"onSelect\", \"onHide\"]],\n    template: function FileInputComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r5 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"i-collapsible\", 0);\n        i0.ɵɵelement(1, \"div\", 1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(2, \"input\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3)(4, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function FileInputComponent_Template_button_click_4_listener() {\n          return ctx.showLibrary();\n        });\n        i0.ɵɵtext(5, \"SELECT\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function FileInputComponent_Template_button_click_6_listener() {\n          i0.ɵɵrestoreView(_r5);\n\n          const _r0 = i0.ɵɵreference(10);\n\n          return _r0.click();\n        });\n        i0.ɵɵtext(7, \" UPLOAD \");\n        i0.ɵɵelement(8, \"img\", 5);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"input\", 6, 7);\n        i0.ɵɵlistener(\"change\", function FileInputComponent_Template_input_change_9_listener($event) {\n          return ctx.onChange($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"i-collapsible\", 0);\n        i0.ɵɵtemplate(12, FileInputComponent_i_image_library_modal_12_Template, 1, 3, \"i-image-library-modal\", 8);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"expanded\", !!ctx.selectedImage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵstyleMapInterpolate1(\"background-image: url(\", ctx.selectedImage == null ? null : ctx.selectedImage.thumb, \");\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"value\", ctx.selectedImage ? ctx.selectedImage.name : \"\");\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"expanded\", ctx.libraryShown);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.libraryShown);\n      }\n    },\n    directives: [i2.CollapsibleComponent, i3.NgIf, i4.ImageLibraryModalComponent],\n    styles: [\"input[type=file][_ngcontent-%COMP%]{display:none}button[_ngcontent-%COMP%]{margin-bottom:12px}button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-left:6px}.preview[_ngcontent-%COMP%]{width:100px;height:100px;margin:6px 0}.close-uploaded[_ngcontent-%COMP%]{margin:6px 0 12px;-webkit-text-decoration:dotted 1px underline;text-decoration:dotted 1px underline;font-size:11px;cursor:pointer}\"]\n  });\n  return FileInputComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}
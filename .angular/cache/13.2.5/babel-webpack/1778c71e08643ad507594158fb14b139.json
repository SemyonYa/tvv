{"ast":null,"code":"import { HttpParams } from '@angular/common/http';\nimport { EventEmitter } from '@angular/core';\nimport { Image } from '../../../../models/Image';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/api/image.rest.service\";\nimport * as i2 from \"src/services/ui.service\";\nimport * as i3 from \"@angular/common\";\n\nconst _c0 = function (a1) {\n  return {\n    \"thumbs-item\": true,\n    \"selected\": a1\n  };\n};\n\nfunction ImageLibraryModalComponent_div_6_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ÉµÉµgetCurrentView();\n\n    i0.ÉµÉµelementStart(0, \"div\", 9);\n    i0.ÉµÉµlistener(\"click\", function ImageLibraryModalComponent_div_6_div_1_Template_div_click_0_listener() {\n      const restoredCtx = i0.ÉµÉµrestoreView(_r6);\n      const image_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ÉµÉµnextContext(2);\n      return ctx_r5.selectImage(image_r4);\n    });\n    i0.ÉµÉµelementStart(1, \"img\", 10);\n    i0.ÉµÉµlistener(\"click\", function ImageLibraryModalComponent_div_6_div_1_Template_img_click_1_listener($event) {\n      const restoredCtx = i0.ÉµÉµrestoreView(_r6);\n      const image_r4 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ÉµÉµnextContext(2);\n      return ctx_r7.showPopup($event, image_r4.id);\n    });\n    i0.ÉµÉµelementEnd()();\n  }\n\n  if (rf & 2) {\n    const image_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ÉµÉµnextContext(2);\n    i0.ÉµÉµstyleMapInterpolate1(\"background-image: url(\", image_r4.thumb, \");\");\n    i0.ÉµÉµproperty(\"ngClass\", i0.ÉµÉµpureFunction1(4, _c0, image_r4 === ctx_r3.selectedImage));\n  }\n}\n\nfunction ImageLibraryModalComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 7);\n    i0.ÉµÉµtemplate(1, ImageLibraryModalComponent_div_6_div_1_Template, 2, 6, \"div\", 8);\n    i0.ÉµÉµelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(1);\n    i0.ÉµÉµproperty(\"ngForOf\", ctx_r0.images);\n  }\n}\n\nfunction ImageLibraryModalComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 11);\n    i0.ÉµÉµtext(1, \" Empty list \");\n    i0.ÉµÉµelementEnd();\n  }\n}\n\nfunction ImageLibraryModalComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 12);\n    i0.ÉµÉµelement(1, \"i-in-progress\", 13);\n    i0.ÉµÉµelementEnd();\n  }\n}\n\nexport let ImageLibraryModalComponent = /*#__PURE__*/(() => {\n  class ImageLibraryModalComponent {\n    constructor(imageRest, ui) {\n      this.imageRest = imageRest;\n      this.ui = ui;\n      this.onSelect = new EventEmitter();\n      this.onHide = new EventEmitter();\n    }\n\n    ngOnInit() {\n      this.fetchData(); // this.imageRest.list$\n      //   .subscribe(\n      //     is => {\n      //       this.images = is?.map(i => new Image(i.id, i.name, i.projectId, i.period));\n      //     }\n      //   );\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n\n    fetchData() {\n      // if (this.projectId || this.period) {\n      let params = new HttpParams();\n\n      if (this.projectId) {\n        params = params.set('project_id', this.projectId.toString());\n      }\n\n      if (this.period) {\n        params = params.set('period', this.period);\n      }\n\n      this.subscription = this.imageRest.getByParams(params).subscribe(items => {\n        console.log(\"ðŸš€ ~ file: image-library-modal.component.ts ~ line 53 ~ ImageLibraryModalComponent ~ fetchData ~ items\", items);\n        this.images = items.map(i => new Image(i.id, i.name, i.projectId, i.period));\n        ;\n      }); // } else {\n      //   this.imageRest.getAll();\n      // }\n    }\n\n    selectImage(image) {\n      // this.selectedImage = image;\n      if (!this.projectId) this.onSelect.emit(image);\n    }\n\n    hide() {\n      this.onHide.emit();\n    }\n\n    showPopup(e, id) {\n      console.log(e);\n      this.ui.showPopup({\n        x: e.clientX,\n        y: e.clientY,\n        msg: 'Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ',\n        callback: () => {\n          console.log(`DELETE ${id}`);\n          this.deleteItem(id);\n          this.fetchData();\n        }\n      });\n    }\n\n    deleteItem(id) {\n      this.imageRest.delete(id).subscribe(() => {\n        this.fetchData();\n      });\n    }\n\n  }\n\n  ImageLibraryModalComponent.Éµfac = function ImageLibraryModalComponent_Factory(t) {\n    return new (t || ImageLibraryModalComponent)(i0.ÉµÉµdirectiveInject(i1.ImageRestService), i0.ÉµÉµdirectiveInject(i2.UiService));\n  };\n\n  ImageLibraryModalComponent.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n    type: ImageLibraryModalComponent,\n    selectors: [[\"i-image-library-modal\"]],\n    inputs: {\n      selectedImage: \"selectedImage\",\n      projectId: \"projectId\",\n      period: \"period\"\n    },\n    outputs: {\n      onSelect: \"onSelect\",\n      onHide: \"onHide\"\n    },\n    decls: 9,\n    vars: 3,\n    consts: [[1, \"wrap\"], [1, \"row\"], [1, \"close-uploaded\"], [\"role\", \"button\", 3, \"click\"], [\"class\", \"thumbs\", 4, \"ngIf\"], [\"class\", \"empty-list\", 4, \"ngIf\"], [\"class\", \"center\", 4, \"ngIf\"], [1, \"thumbs\"], [3, \"ngClass\", \"style\", \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"ngClass\", \"click\"], [\"src\", \"/assets/icons/close.svg\", \"alt\", \"CLOSE\", 1, \"close\", 3, \"click\"], [1, \"empty-list\"], [1, \"center\"], [\"size\", \"36px\", \"margin\", \"48px\"]],\n    template: function ImageLibraryModalComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ÉµÉµelementStart(0, \"div\", 0)(1, \"h3\", 1);\n        i0.ÉµÉµtext(2, \" Select image \");\n        i0.ÉµÉµelementStart(3, \"div\", 2)(4, \"span\", 3);\n        i0.ÉµÉµlistener(\"click\", function ImageLibraryModalComponent_Template_span_click_4_listener() {\n          return ctx.hide();\n        });\n        i0.ÉµÉµtext(5, \"Close\");\n        i0.ÉµÉµelementEnd()()();\n        i0.ÉµÉµtemplate(6, ImageLibraryModalComponent_div_6_Template, 2, 1, \"div\", 4);\n        i0.ÉµÉµtemplate(7, ImageLibraryModalComponent_div_7_Template, 2, 0, \"div\", 5);\n        i0.ÉµÉµtemplate(8, ImageLibraryModalComponent_div_8_Template, 2, 0, \"div\", 6);\n        i0.ÉµÉµelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ÉµÉµadvance(6);\n        i0.ÉµÉµproperty(\"ngIf\", ctx.images);\n        i0.ÉµÉµadvance(1);\n        i0.ÉµÉµproperty(\"ngIf\", (ctx.images == null ? null : ctx.images.length) === 0);\n        i0.ÉµÉµadvance(1);\n        i0.ÉµÉµproperty(\"ngIf\", !ctx.images);\n      }\n    },\n    directives: [i3.NgIf, i3.NgForOf, i3.NgClass],\n    styles: [\"h3[_ngcontent-%COMP%]{margin-bottom:12px}.close-uploaded[_ngcontent-%COMP%]{margin:6px 0 12px;-webkit-text-decoration:dotted 1px underline;text-decoration:dotted 1px underline;font-size:11px;cursor:pointer;font-weight:400}.thumbs-item[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:flex-start;padding:2px;background-clip:border-box}.thumbs-item[_ngcontent-%COMP%]   img.close[_ngcontent-%COMP%]{width:11px;cursor:pointer}\"]\n  });\n  return ImageLibraryModalComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}